<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title></title>
    <link rel="icon" href="data:," />
  </head>
  <body>
    <img src="./img.png" alt="" />
  </body>
  <script>
    function runFetch(url, fetchInit) {
      return fetch(url, fetchInit).then(async (res) => {
        if (!res.ok)
          return Promise.reject(
            new RangeError(
              `${res.status} '${res.statusText}' received instead of 200-299 range`
            )
          );
        const contentType = res.headers.get("content-type");
        const contentLength = res.headers.get("content-length");
        if (res.status === 204 || contentLength === "0") return undefined;
        if (contentType?.includes("application/json")) {
          return res.json();
        } else if (contentType?.includes("text/")) {
          return res.text();
        } else {
          return res.arrayBuffer().then((p) => new Uint8Array(p));
        }
      });
    }

    const r = runFetch("/resource")
      .catch((err) => err)
      .then((r) => console.log("response:", r));
  </script>
</html>
